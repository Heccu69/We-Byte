# Настройка тарелки UnderCake

## Проблема
Тарелка прозрачная (без коллайдера), коржи проваливаются сквозь нее, и тараканы не могут взаимодействовать с тортом.

---

## Решение: Добавление коллайдера к тарелке

### Шаг 1: Выберите тарелку
1. Найдите объект **UnderCake** в Hierarchy
2. Выберите его

### Шаг 2: Добавьте Box Collider 2D
1. В Inspector нажмите **Add Component**
2. Найдите и добавьте **Box Collider 2D**

### Шаг 3: Настройте коллайдер
В компоненте **Box Collider 2D**:
- **Is Trigger**: ☐ (выключено) - тарелка должна быть твердой
- **Size**: настройте размер коллайдера по размеру тарелки
  - Например: X = 2, Y = 0.2
- **Offset**: при необходимости отрегулируйте позицию

### Шаг 4: Добавьте тег "Cake"
1. В Inspector найдите поле **Tag** (вверху)
2. Если тега "Cake" нет в списке:
   - Выберите **Add Tag...**
   - Нажмите **+**
   - Введите **"Cake"**
   - Сохраните
3. Вернитесь к объекту UnderCake
4. Установите тег **"Cake"**

### Шаг 5: Проверьте Rigidbody2D (опционально)
Если тарелка должна быть неподвижной:
1. Если есть **Rigidbody2D**:
   - **Body Type**: Static (неподвижная)
2. Если нет Rigidbody2D - можно не добавлять

---

## Настройка CakeManager

### Шаг 1: Убедитесь, что CakeManager создан
1. Найдите объект **CakeManager** в Hierarchy
2. Если его нет - создайте (см. CAKE_STEALING_SETUP.md)

### Шаг 2: Назначьте тарелку
1. Выберите объект **CakeManager**
2. В Inspector найдите компонент **Cake Manager**
3. В поле **Under Cake Plate** перетащите объект **UnderCake** из Hierarchy

### Шаг 3: Проверьте настройки
- **Base Steal Speed**: 0.5
- **Speed Per Enemy**: 0.3
- **Queue Spacing**: 0.5
- **First Enemy Offset**: X: 0.5, Y: 0, Z: 0

---

## Проверка работы

### 1. Запустите игру
Посмотрите в консоль Unity - должны появиться сообщения:

```
=== Начинаем автоматический сбор коржей ===
Найдено объектов PickupObject: X
Проверяем объект: [имя], тип: Korzh
  - Корж [имя] на расстоянии X.XX от тарелки
  ✓ Корж [имя] добавлен в список!
=== CakeManager собрал X коржей ===
```

### 2. Проверьте коллизию тарелки
- Коржи должны **лежать** на тарелке, а не проваливаться
- Игрок не должен проходить сквозь тарелку

### 3. Проверьте тараканов
- Создайте таракана (через EnemySpawner)
- Таракан должен идти к тарелке
- При достижении тарелки в консоли должно появиться:
  ```
  Таракан добавлен в очередь. Всего тараканов: 1
  Тараканы утаскивают корж! Скорость: 0.5 (тараканов: 1)
  ```

---

## Возможные проблемы

### Коржи все равно проваливаются
**Решение:**
1. Проверьте, что у тарелки есть **Box Collider 2D**
2. Проверьте, что **Is Trigger** выключен
3. Увеличьте **Size Y** коллайдера (например, до 0.5)
4. Убедитесь, что у коржей есть **Rigidbody2D** и **Collider2D**

### CakeManager не находит коржи
**Решение:**
1. Посмотрите в консоль - там будут подробные сообщения:
   ```
   === Начинаем автоматический сбор коржей ===
   Найдено объектов PickupObject: 0
   ```
   Если найдено 0 объектов - коржи не имеют компонента PickupObject!

2. **Проверьте префаб коржа:**
   - Найдите префаб коржа в Assets
   - Выберите его
   - В Inspector проверьте наличие компонента **PickupObject**
   - Если его нет - добавьте:
     - **Add Component → Pickup Object**
     - **Object Type**: Korzh
     - **Object Name**: "Корж"

3. **Если используете ConveyorSpawner:**
   - Обновленный код автоматически добавляет PickupObject к коржам
   - В консоли должно появиться: `"Добавлен компонент PickupObject к коржу [имя]"`

4. Проверьте расстояние от коржей до тарелки (должно быть < 9 единиц)

5. Убедитесь, что тарелка назначена в CakeManager

### Тараканы не регистрируются
**Решение:**
1. Проверьте, что у тарелки есть тег **"Cake"**
2. Проверьте, что CakeManager создан в сцене
3. Посмотрите консоль на наличие сообщений:
   - `"Таракан нашел тарелку: [имя]"` - таракан нашел цель
   - `"CakeManager не найден!"` - создайте CakeManager

### Коржи не утаскиваются
**Решение:**
1. Проверьте, что в консоли есть сообщение `"CakeManager собрал X коржей"` (X > 0)
2. Если X = 0, проверьте:
   - Коржи рядом с тарелкой (в радиусе 9 единиц)
   - У коржей есть PickupObject с типом Korzh
   - Коржи не движутся и не связаны с платформой
   - Тарелка назначена в CakeManager

---

## Альтернативное решение: Ручное добавление коржей

Если автоматический сбор не работает:

1. Выберите **CakeManager** в Hierarchy
2. В Inspector найдите **Cake Layers**
3. Установите **Size** = количество коржей (например, 3)
4. Перетащите коржи из Hierarchy в список
5. **Важно**: добавляйте снизу вверх!

---

## Краткая инструкция

1. ✅ Добавьте **Box Collider 2D** к тарелке UnderCake
2. ✅ Установите **Is Trigger = false**
3. ✅ Добавьте тег **"Cake"** к тарелке
4. ✅ Назначьте тарелку в **CakeManager → Under Cake Plate**
5. ✅ Запустите игру и проверьте консоль

Теперь коржи не будут проваливаться, и тараканы смогут их утаскивать!
