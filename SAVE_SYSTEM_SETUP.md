# Система сохранения и прогресса

## Обновленные и добавленные скрипты

### 1. **SaveData.cs** (обновлен)
Расширенная структура данных для сохранения:
- **Настройки:**
  - `selectedLanguage` - выбранный язык (en/ru)
- **Прогресс игры:**
  - `currentLevel` - текущий уровень
  - `currentScore` - текущие очки в сессии
  - `highScore` - лучший счет
  - `totalCompletedOrders` - всего выполнено заказов
  - `totalCorrectOrders` - всего правильных заказов

### 2. **LocalCelector.cs** (новый)
Управление локализацией с сохранением выбранного языка:
- Переключение между языками (en/ru)
- Автоматическое сохранение выбора через GameManager или напрямую
- Интеграция с Unity Localization

### 3. **ScoreManager.cs** (обновлен)
Управление очками с автосохранением:
- Текущий счет и лучший счет
- Автоматическое сохранение при изменении очков
- Загрузка прогресса при старте
- Методы для сброса и установки счета

### 4. **OrderSystem.cs** (обновлен)
Система заказов со статистикой:
- Сохранение статистики выполненных заказов
- Подсчет правильных и неправильных заказов
- Интеграция со ScoreManager

---

## Как это работает

### Сохранение очков:
1. Игрок выполняет заказ правильно
2. `OrderSystem` вызывает `ScoreManager.AddScore(1)`
3. `ScoreManager` автоматически сохраняет:
   - Текущий счет
   - Лучший счет (если текущий больше)
4. `OrderSystem` сохраняет статистику заказов

### Сохранение языка:
1. Игрок выбирает язык в меню
2. `LocalCelector.ChangeLocale(localeID)` вызывается
3. Язык применяется через Unity Localization
4. Выбор сохраняется в `SaveData.selectedLanguage`

### Загрузка при старте:
1. `ScoreManager.Start()` загружает:
   - Текущий счет
   - Лучший счет
2. `GameManager` (если есть) загружает язык

---

## Настройка в Unity

### 1. ScoreManager
1. Создайте пустой объект **ScoreManager** в сцене
2. Добавьте компонент **Score Manager**
3. В Inspector:
   - **Score Text**: перетащите TextMeshProUGUI для отображения очков

### 2. LocalCelector
1. Создайте пустой объект **LocaleSelector** в сцене меню
2. Добавьте компонент **Local Celector** (файл: `LocalCelector.cs`)
3. Привяжите к кнопкам выбора языка:
   - Кнопка EN: `LocalCelector.ChangeLocale(0)`
   - Кнопка RU: `LocalCelector.ChangeLocale(1)`

**Важно:** Используется файл `LocalCelector.cs` (с буквой C), а не LocalSelector!

### 3. OrderSystem
- Уже настроен, автоматически сохраняет статистику

---

## Примеры использования

### Получить текущий счет:
```csharp
int score = ScoreManager.Instance.GetScore();
```

### Получить лучший счет:
```csharp
int highScore = ScoreManager.Instance.GetHighScore();
```

### Сбросить счет (новая игра):
```csharp
ScoreManager.Instance.ResetScore();
```

### Получить статистику заказов:
```csharp
SaveData data = SaveSystem.Load();
int total = data.totalCompletedOrders;
int correct = data.totalCorrectOrders;
float accuracy = (float)correct / total * 100f;
```

---

## Что сохраняется автоматически

✅ **При добавлении очков:**
- Текущий счет
- Лучший счет

✅ **При выполнении заказа:**
- Статистика заказов (всего/правильных)

✅ **При смене языка:**
- Выбранный язык

---

## Проверка работы

### 1. Запустите игру
### 2. Выполните несколько заказов
### 3. Посмотрите в консоль:
```
Очки добавлены! Текущий счет: 1
✅ Заказ выполнен ПРАВИЛЬНО! 3 коржей
```

### 4. Остановите игру и запустите снова
- Счет должен загрузиться из сохранения
- Лучший счет сохранен

### 5. Смените язык
- В консоли: `"Язык сохранен: ru"`
- При следующем запуске язык применится автоматически

---

## Файл сохранения

Данные сохраняются в:
```
C:\Users\[Username]\AppData\LocalLow\[CompanyName]\[ProductName]\savedata.json
```

Можно удалить файл для сброса всего прогресса.

---

## Готово!

Все скрипты добавлены и интегрированы. Система автоматически сохраняет:
- Очки и рекорды
- Статистику заказов
- Настройки языка

